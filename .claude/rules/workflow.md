# ワークフロー規約

## アトミック操作の原則
マルチステップワークフロー（commit/push、ブランチ操作、Issue駆動開発）では、**各ステップの完了を確認してから次に進むこと**。

セッションが突然終了する可能性がある場合は、**アトミックな操作を優先的に完了させる**:

1. **コミット優先**: 複数ファイルの変更より、1つの意味のある変更をコミット
2. **プッシュ前確認**: `git status` でステージング状態を確認
3. **ブランチ操作**: 削除前にマージ完了を確認

### 推奨フロー
```
変更作成 → テスト実行 → ✅確認 → コミット → ✅確認 → プッシュ → ✅確認 → 次のタスク
```

**❌ 避けるべきパターン**: 複数の変更を一気に行い、最後にまとめてコミット

## デバッグ手順

エラーが共有されたら、**修正を提案する前に**以下の手順を実行:

1. **スタックトレースから特定**: エラーの正確なファイルと行番号を特定
2. **該当ファイルを読む**: エラー箇所とその周辺コードを確認
3. **依存関係を読む**: インポート先、呼び出し元など関連ファイルを確認
4. **根本原因を説明**: なぜこのエラーが発生したかを説明
5. **修正を提案**: 根本原因に対する修正を提案

```
❌ 間違い: エラーメッセージだけ見て修正を提案
✅ 正しい: ファイル読み込み → 依存関係確認 → 根本原因説明 → 修正提案
```

## コンパクション復帰プロトコル（全エージェント必須）

コンパクション後は、作業を再開する前に**必ず**以下を実行せよ:

1. **自分のペイン名を確認する**:
   ```bash
   tmux display-message -p '#W'
   ```

2. **対応するエージェント定義を読み直す**:
   - conductor → `.claude/agents/conductor.md`
   - dispatch → `.claude/agents/dispatch.md`
   - reviewer → `.claude/agents/reviewer.md`
   - （その他、自分の役割に対応するファイル）

3. **禁止事項を確認してから作業開始**

4. **現在のタスクをダッシュボードで確認**:
   ```bash
   cat status/dashboard.md
   ```

summaryの「次のステップ」を見てすぐ作業してはならぬ。
**まず自分が誰かを確認せよ。**
